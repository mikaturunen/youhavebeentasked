<link rel="import" href="/public/bower/polymer/polymer.html">
<link rel="import" href="/public/bower/core-collapse/core-collapse.html">

<polymer-element 
    name="yhbt-task"
    attributes="task">
    
    <template>
        <style>
        .collapse-content {
            padding: 15px;
            border: 1px solid #dedede;
        }
        </style>

        <div class="task">
            <div on-click="{{toggle}}">{{task.title}}</div>

            <core-collapse id="{{task.id | createId}}">
                <div class="collapse-content">
                    {{task.description}}
                </div>
            </core-collapse>
        </div>
    </template>
    <script>
        Polymer({
            task: {
                description: "",
                title: "",
                events: [],
                done: false
            },

            createId: function(value) {
                return "task-" + value;
            },  

            toggle: function() {
                this.$["task-" + this.task.id].toggle();
            },

            /**
             * Starts the current task
             */
            start: function() {
                var currentDate = Date.now();
                this.task.events.push({
                    start: currentDate
                });
            },
            
            /**
             * Pauses the current task
             */
            pause: function() {
                this.task.events[this.events.length - 1].end = Date.now();
            },

            /**
             * Finishes the current task and marks it as done.
             */
            finish: function() {
                this.task.events[this.events.length - 1].end = Date.now();
                this.task.done = true;
            }
        });
    </script>
</polymer-element>